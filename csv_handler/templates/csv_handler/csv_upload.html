<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CSV Upload</title>
  </head>
  <body>
    <h1>Upload CSV File</h1>

    <form
      method="post"
      enctype="multipart/form-data"
      action="{% url 'csv_upload' %}"
    >
      {% csrf_token %}
      <label for="file">Choose CSV file:</label>
      <input type="file" name="file" id="file" accept=".csv" required />
      <button type="submit">Upload</button>
    </form>

    {% if error %}
    <p style="color: red">{{ error }}</p>
    {% endif %} {% if summary %}
    <h2>Upload Summary</h2>
    <p>Total Records Saved: {{ summary.total_saved }}</p>
    <p>Total Records Rejected: {{ summary.total_rejected }}</p>

    {% if summary.rejected_records %}
    <h3>Rejected Records:</h3>
    <ul>
      {% for error in summary.rejected_records %}
      <li>Row {{ error.row }}: {{ error.error }}</li>
      {% endfor %}
    </ul>
    {% endif %} {% endif %}
  </body>
</html>

{% comment %} <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CSV Upload</title>
  </head>
  <body>
    <h1>Upload CSV File</h1>

    <form
      method="post"
      enctype="multipart/form-data"
      action="{% url 'csv_upload' %}"
    >
      {% csrf_token %}
      <label for="file">Choose CSV file:</label>
      <input type="file" name="file" id="file" accept=".csv" required />
      <button type="submit">Upload</button>
    </form>

    {% if summary %}
    <h2>Upload Summary</h2>
    <p>Total Records Saved: {{ summary.total_saved }}</p>
    <p>Total Records Rejected: {{ summary.total_rejected }}</p>

    {% if summary.rejected_records %}
    <h3>Rejected Records:</h3>
    <ul>
      {% for error in summary.rejected_records %}
      <li>Row {{ error.row }}: {{ error.errors }}</li>
      {% endfor %}
    </ul>
    {% endif %} {% endif %} {% if users %}
    <h3>Uploaded Users:</h3>
    <table border="1">
      <tr>
        <th>Name</th>
        <th>Email</th>
        <th>Age</th>
      </tr>
      {% for user in users %}
      <tr>
        <td>{{ user.name }}</td>
        <td>{{ user.email }}</td>
        <td>{{ user.age }}</td>
      </tr>
      {% endfor %}
    </table>
    {% endif %}
  </body>
</html>
{% endcomment %}
